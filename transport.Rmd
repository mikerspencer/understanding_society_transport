---
title: "Transport"
author: "Mike Spencer"
date: "25/11/2021"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages}
library(tidyverse)
library(haven)
library(knitr)
```


## Intro


```{r data}
df = read_dta("~/Cloud/personal/gofcoe/understanding_society/6614stata_B17CC6790677EF32F72CE50881AE98E1B9FC1F79133B07B63B353396D3AB917A_V1/UKDA-6614-stata/stata/stata13_se/ukhls_w10/j_indresp.dta")
```

## Transport to work variables

### Main mode of transport to work

```{r commute main}
df %>% 
  count(j_wktrvfar)
```


### Mode(s) of transport for journey to work

Variables:

* wktrv1 	Drive myself by car or van
* wktrv2 	Get a lift with someone from household
* wktrv3 	Get a lift with someone outside the household
* wktrv4 	Motorcycle/moped/scooter
* wktrv5 	Taxi/minicab
* wktrv6 	Bus/coach
* wktrv7 	Train
* wktrv8 	Underground/Metro/Tram/Light railway
* wktrv9 	Cycle
* wktrv10 	Walk
* wktrv97 	Other


Response options:

* Value = 0.0	Label = Not mentioned
* Value = 1.0	Label = Yes mentioned
* Value = -1.0	Label = don't know
* Value = -9.0	Label = missing
* Value = -8.0	Label = inapplicable
* Value = -7.0	Label = proxy
* Value = -2.0	Label = refusal

Employed:

```{r employed}
df %>% 
  select(pidp, contains("j_wktrv"), -j_wktrvfar) %>% 
  pivot_longer(cols = !pidp) %>% 
  count(name, value) %>% 
  pivot_wider(names_from = name, values_from = n)
```

Self employed:

```{r self employed}
df %>% 
  select(pidp, contains("j_jswktrv"), -j_jswktrvfar) %>% 
  pivot_longer(cols = !pidp) %>% 
  count(name, value) %>% 
  pivot_wider(names_from = name, values_from = n)
```

Larissa Pople states that I can add together travel from employed and self employed categories.

### How many people report multiple modes?

```{r multi-report}
df %>% 
  select(pidp, contains("wktrv"), -j_wktrvfar, -j_jswktrvfar) %>% 
  pivot_longer(cols = !pidp) %>% 
  mutate(name = str_replace(name, "j_js", "j_")) %>% 
  filter(value == 1) %>% 
  count(pidp, name = "modes") %>% 
  count(modes, name = "respondents")
```


## Income data

### Hours worked

```{r hours}
df %>% 
  count(j_jbhrs)
```


### Usual pay

```{r usual pay}
df %>% 
  count(j_payu)
```

